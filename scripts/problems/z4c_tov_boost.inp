<job>
problem_id = z4c_grhd_tov_boost

<z4c>
#dt_assert_is_finite = 1   # whatever values, if zero / missing these tasks are not triggered
dt_wave_extraction =0.1
lapse_harmonic = 0.0
lapse_harmonicf = 1.0
lapse_oplog = 2.0
lapse_advect = 1.0
shift_eta = 0.3
shift_advect = 1.0

# Kreiss-Oliger dissipation parameter.
diss = 0.5 # 0.5
chi_div_floor = 1e-05
# Constraint damping factor 1.
damp_kappa1 = 0.02 # 0.02
# Constraint damping factor 2.
damp_kappa2 = 0.0

bitant = false

<trackers_extrema>  # =====================================
N_tracker = 1
filename = tra.ext

control_field = Z4c.chi

ini_1_x1 = 0               # initial offset
ini_1_x2 = 0
ini_1_x3 = 0
minima_1 = true              # for update_strategy = 1
ref_level_1 = 3
ref_type_1 = 1              # 0: to the point, 1: sph. region
ref_zone_radius_1 = 2


update_strategy = 1         # 0: based on dt, 1: based on quad interp.
# safety factor avoids taking too large step (multiple of local dx)
update_max_step_factor = 10
# =========================================================


<output1>
file_type = hdf5
variable  = cons
dt        = 1e-3
ghost_zones=true
#x2_slice = 0.0
x3_slice = 0.0
data_format=%.15g

<output2>
file_type = hdf5
variable  = prim
dt        = 1e-3
ghost_zones=true
#x2_slice = 0.0
x3_slice = 0.0
data_format=%.15g

<output4>
file_type = hdf5
variable  = adm
dt        = 1e-3
ghost_zones=true
#x2_slice = 0.0
x3_slice = 0.0
data_format=%.15g

# 
<output5>
file_type = hdf5
variable  = z4c
dt        = 1e-3
ghost_zones=true
#x2_slice = 0.0
x3_slice = 0.0
data_format=%.15g

# <output4>
# file_type       = hdf5                 # Athena++ hdf5 data
# variable        = con                  # variables to be output
# dt              = 0.1                  # time increment between outputs
# data_format     = %.16e
# x2_slice = 0
# x3_slice = 0

<output6>
file_type = hdf5
variable  = con
dt        = 1e-3
ghost_zones=true
# x2_slice = 0.0
x3_slice = 0.0
data_format=%.15g

<output7>
file_type = hst
dt        = 0.1
# data_format=%.2g
data_format=%.2e

<output8>
file_type = rst
dt        = 200


<time>
cfl_number = 0.25
# nlim       = 10000
# tlim       = 10000
# nlim       = 1000
tlim       = 10
integrator = rk1   # time integration algorithm
xorder     = 5    # order of spatial reconstruction
ncycle_out = 1      # interval for stdout summary info

<mesh>
nx1    = 64    # number of cells in x-direction
x1min  = -40   # minimum x
x1max  = 40 # maximum x
ix1_bc = extrapolate_outflow  # lower boundary
ox1_bc = extrapolate_outflow  # upper boundary

nx2    = 64  # number of cells in y-direction
x2min  = -40  # minimum y
x2max  = 40  # maximum y
ix2_bc = extrapolate_outflow # lower boundary
ox2_bc = extrapolate_outflow # upper boundary

nx3    = 64        # number of cells in z-direction
x3min  = -40   # minimum z
x3max  = 40       # maximum z
ix3_bc = extrapolate_outflow  # lower  boundary
ox3_bc = extrapolate_outflow  # upper boundary

refinement = none
# maximum
numlevel = 4
#deref_count = 5

num_threads = 12

<meshblock>
nx1=16
nx2=16
nx3=16

<refinement1>
x1min           = -10
x1max           = 10
x2min           = -10
x2max           = 10
x3min           = -10
x3max           = 10
level           = 2

<hydro>
gamma = 2  # ratio of specific heats Gamma
k_adi = 100                # adiabat K, p_gas = K rho^Gamma
dfloor = 1e-50                # floor value for rho equiv atmosphere rho
pfloor = 1e-50                # floor value for rho equiv atmosphere rho
rho_min=1e-50
pgas_min=1e-50
fix_fluxes=0 #use initial data in flux calculation
fix_sources=0 #use initial data in hydro source calculation (stationary spacetime only)
zero_sources=0 # set hydro sources to 0
zero_div=0 # set div F = 0 i.e. don't update conservatives with fluxes

<problem>

# TOV: central density
rhoc = 0.00128

# TOV: starting integration radius
rmin = 0 # 1e-14
# TOV: integration step-size & max-points
dr   = 1e-4  # TOV integration step
npts = 10000000
# TOV: spacing & number of points to retain for polar->cart interpolation
interp_dr   = 1e-4
interp_npts = 10000000

# TOV: minimum step-size for surface identification
surf_dr = 1e-14

# TOV: spatial offset & boost params
x_0_x1 = 0.0
x_0_x2 = 0.0
x_0_x3 = 0.0

v_b_x1 = 0.2
v_b_x2 = 0. # 0.1
v_b_x3 = 0. # -0.1

# Atmosphere settings
fatm = 0.00000000000000078125  # set atmosphere rho to rho = rhomax * fatm
fthr = 1  # set point to atmosphere if rho < fthr*fatm*rhomax
