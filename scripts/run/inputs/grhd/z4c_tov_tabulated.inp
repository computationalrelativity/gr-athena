<comment> # ===================================================================
# additional comments (such as e.g. compilation parameters go here)
# ...
# =============================================================================

<job> # =======================================================================
problem_id = z4c_tov
# =============================================================================

<z4c> # =======================================================================
lapse_harmonic  = 0.0
lapse_harmonicf = 1.0
lapse_oplog     = 2.0
lapse_advect    = 1.0
lapse_K         = 0.0

shift_Gamma       = 1     # T 2011: BNS takes 0.75
shift_eta         = 0.3   # T 2011
shift_alpha2Gamma = 0.0
shift_H           = 0.0
shift_advect      = 1.0

# Kreiss-Oliger dissipation parameter.
diss = 0.1
# conformal factor flooring
chi_div_floor = 1e-10

# Constraint damping factors
damp_kappa1 = 0.02
damp_kappa2 = 0.0

# do not compute constraints outside this radius (relative to origin)
r_max_con = 18

# Cowling? (set metric rhs  = 0)
cowling_true = 0
fixedgauge = 0 # set rhs of gauge = 0
fix_admsources = 0 # calculate adm sources with initial data
# =============================================================================

<task_triggers>  # ============================================================
# control frequency of task execution; certain constraints are augmented
# further automatically by choices in output block

# missing / zero values do not get activated
adjust_mesh_dt = true

tracker_extrema = 0.25
dt_Z4c_Weyl     = 0.0
# =============================================================================

<trackers_extrema>  # =========================================================
N_tracker = 1
filename = tra.ext

control_field = Z4c.chi

ini_1_x1 = 0               # initial offset
ini_1_x2 = 0
ini_1_x3 = 0
minima_1 = true              # for update_strategy = 1
ref_level_1 = 1
ref_type_1 = 1              # 0: to the point, 1: sph. region
ref_zone_radius_1 = 10.5


update_strategy = 1         # 0: based on dt, 1: based on quad interp.
# safety factor avoids taking too large step (multiple of local dx)
update_max_step_factor = 10
# =============================================================================

<time> # ======================================================================
cfl_number   = 0.2
tlim	       = 0.1
integrator   = rk3   # time integration algorithm

# spatial reconstruction - element of:
# {donate, lin_vl, lin_mc2, ppm, ceno3, weno5, weno5z, weno5d_si,
#  mp3, mp5, mp7, mp5_R}

xorder = weno5z
xorder_eps = 1e-40

xorder_use_fb = false             # control if fallback is used
xorder_use_fb_unphysical = false  # optinally verify (fluid) energy cond.
xorder_fb = lin_vl

floor_both_states = false  # reset both l/r [Reprimand only]

ncycle_out   = 1      # interval for stdout summary info
# =============================================================================

<mesh> # ======================================================================
# no. cell in dir, min/max x, inner/outer BC
nx1    = 64
x1min  = -25
x1max  = 25
ix1_bc = extrapolate_outflow
ox1_bc = extrapolate_outflow

nx2    = 64
x2min  = -25
x2max  = 25
ix2_bc = extrapolate_outflow
ox2_bc = extrapolate_outflow

nx3    = 64
x3min  = -25
x3max  = 25
ix3_bc = extrapolate_outflow
ox3_bc = extrapolate_outflow

refinement = adaptive
numlevel = 10
#deref_count = 5

num_threads = 4

# impose bitant symmetry (use with ix3_bc=reflecting)
bitant = false
# =============================================================================

<meshblock> # =================================================================
nx1=16
nx2=16
nx3=16
# =============================================================================


<hydro> # =====================================================================
# gamma      = 2     # ratio of specific heats Gamma
# k_adi      = 100.  # adiabat K, p_gas = K rho^Gamma
# c2p_acc    = 1e-12
# rho_strict = 0 # 1e-20

fix_fluxes=0 #use initial data in flux calculation
fix_sources=0 #use initial data in hydro source calculation (stationary spacetime only)
zero_sources=0 # set hydro sources to 0
zero_div=0 # set div F = 0 i.e. don't update conservatives with fluxes

table = /mnt/hyperion/_Data/GR-Athena++/tabulated/SFHo/CX_Tabul_TOV/SFHo.h5
lorene = /mnt/hyperion/_Data/GR-Athena++/tabulated/SFHo/CX_Tabul_TOV/SFHo_T2_beta.lorene
lorene_Y = /mnt/hyperion/_Data/GR-Athena++/tabulated/SFHo/CX_Tabul_TOV/SFHo_T2_beta_Y.out

dfloor = 4.3391894561306809e-12
pfloor = 2.2367497199912880e-13
tfloor = 0.12022644
y0_atmosphere = 0.456464
dthreshold = 1.000001 # if rho<dfloor*dthreshold -> rho=rho_atm

# control whether to split fluxes and reconstruct those [GRHD only]
flux_reconstruction = false

# =============================================================================


<problem> # ===================================================================

# TOV: central density
rhoc = 0.00128

# TOV: starting integration radius
rmin = 0
# TOV: integration step-size & max-points
dr   = 1e-2  # TOV integration step
npts = 10000000
# TOV: spacing & number of points to retain for polar->cart interpolation
interp_dr   = 1e-2
interp_npts = 100000

# # TOV: starting integration radius
# rmin = 0
# # TOV: integration step-size & max-points
# dr   = 1e-3  # TOV integration step
# npts = 100000000
# # TOV: spacing & number of points to retain for polar->cart interpolation
# interp_dr   = 1e-2
# interp_npts = 10000000

# TOV: minimum step-size for surface identification
surf_dr = 1e-14

# TOV: spatial offset & boost params
x_0_x1 = 0.0
x_0_x2 = 0.0
x_0_x3 = 0.0

v_b_x1 = 0. # 0.2
v_b_x2 = 0. # 0.1
v_b_x3 = 0. # -0.1

# Atmosphere settings
fatm = 1e-18  # set atmosphere rho to rho = fatm
fthr = 1    # set point to atmosphere if rho < fthr*fatm

max_z = 10
# =============================================================================

<refinement1> # ===============================================================
x1min           = -10
x1max           = 10
x2min           = -10
x2max           = 10
x3min           = -10
x3max           = 10
level           = 1
# =============================================================================

# <refinement2> # ===============================================================
# x1min           = -5
# x1max           = 5
# x2min           = -5
# x2max           = 5
# x3min           = -5
# x3max           = 5
# level           = 2
# # =============================================================================


#
# :D
#