<comment> # ===================================================================
# additional comments (such as e.g. compilation parameters go here)
# ...
# =============================================================================

<job> # =======================================================================
problem_id = shadow
# =============================================================================

<time> # ======================================================================
cfl_number   = 0.4
tlim	       = 10
ncycle_out   = 1      # interval for stdout summary info
# =============================================================================

<mesh> # ======================================================================
# no. cell in dir, min/max x, inner/outer BC
nx1    = 220
x1min  = -2
x1max  = 4
ix1_bc = user
ox1_bc = outflow

nx2    = 220
x2min  = -3
x2max  = 3
ix2_bc = outflow
ox2_bc = outflow

nx3    = 4
x3min  = -1
x3max  = 1
ix3_bc = outflow
ox3_bc = outflow

refinement = none
num_threads = 12
# =============================================================================

<meshblock> # =================================================================
nx1 = 20
nx2 = 20
nx3 = 4
# =============================================================================

<M1> # ========================================================================
ngroups  = 1
nspecies = 1

# element of:
# {thin,
#  thick,
#  Minerbo,    - Brent-Dekker (GSL based)
#  MinerboP    - Picard
#  MinerboN    - Newton-Raphson
# }
closure_variety = MinerboN

# element of: {approximate, exact}
characteristics_variety = approximate

# element of: {fluid, mixed, zero, none}
fiducial_velocity = fluid

# element of:
# {full_explicit,               - non-stiff regime
#  semi_implicit_PicardFrozenP  - only for fixed (P_dd)
#  semi_implicit_PicardMinerboP - updates P_dd based on Minerbo
# }
integration_strategy = semi_implicit_PicardMinerboP

# tolerances / ad-hoc fiddle parameters
fl_E = 1e-15
fl_J = 1e-15
eps_E = 1e-5
eps_J = 1e-10
min_flux_A = 0

# [Minerbo] closure root tolerance & maximum iterations
eps_C          = 1e-4
eps_C_N        = 1e-10  // switch to Picard if deriv. below this
max_iter_C     = 32
max_iter_C_rst = 10
w_opt_ini_C    = 0.5
fac_amp_C      = 1.10  // error amplification tolerance between iterates
reset_thin     = true  // reset on failure to thin limit
verbose_iter_C = true

# [Picard] iteration settings
max_iter_P     = 256   // maximum number of iterations (for each restart)
max_iter_P_rst = 10    // maximum number of restarts
w_opt_ini_P    = 0.5   // initial underrelaxation factor
eps_P_abs_tol  = 1e-10  // absolute tolerance
fac_amp_P      = 1.10  // error amplification tolerance between iterates
verbose_iter_P = true  // signal e.g. failure to achieve tol.

# =============================================================================

<M1_opacities> # ==============================================================
# element of: {zero, none}
variety = none
# =============================================================================

<problem> # ===================================================================
test = shadow

rho    = 1
kap_a  = 1
kap_s  = 0
R_star = 1
abs_v  = 0
# =============================================================================

<refinement1> # ===============================================================
x1min =  -0.2
x1max =  0.2
x2min = -1.0
x2max = -1.0
x3min = -1.0
x3max =  1.0
level = 2
# =============================================================================

# dumped quantities ===========================================================
# <output1>
# file_type = rst
# dt        = 1

<output2>
file_type   = hdf5
variable    = m1_lab
dt          = 0.1
ghost_zones = true

<output2>
file_type   = hdf5
variable    = m1_lab
dt          = 0.1
ghost_zones = true
x2_slice    = 0.0
x3_slice    = 0.0

<output3>
file_type   = hdf5
variable    = m1_lab_aux
dt          = 0.1
ghost_zones = true
x2_slice    = 0.0
x3_slice    = 0.0

<output4>
file_type   = hdf5
variable    = m1_lab
dt          = 0.1
ghost_zones = true
x3_slice    = 0.0

<output5>
file_type   = hdf5
variable    = m1_lab_aux
dt          = 0.1
ghost_zones = true
x3_slice    = 0.0

#
# :D
#